const puppeteer = require('puppeteer')


const excludedSections = `.content-container {background-color:transparent;} #pdf-text-banner { display: none;} #pdf-edit-content{ display: none;} #pdf-footer{ display: none;} #pdf-paginator{ display: none;} .breadcrumbs{ display: none;} #download-modal{ display:none;} #download-pdf-btn{ display:none;}`

const printPdf = async (options,res,archive) => {
    const pdfBlobArr = []
    const browser = await puppeteer.launch({
        headless: true
    });
    const headerTemplate = `<div style="background-color: #006AC6; height: 50px; width: 100%; text-align: left; padding-left: 40px; margin-bottom:20px; color: white;">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTE5IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTE5IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfNjQ0Ml8xMTA0NikiPgo8cGF0aCBkPSJNNTUuMjg3OCA0LjY5NDY3QzU2LjIxNzcgNC42ODA2NyA1Ny4xNDE2IDQuODQ2MDUgNTguMDA5IDUuMTgxNzNDNTguNzgzNiA1LjQ4NTQ2IDU5LjQ5MDIgNS45NDAxOCA2MC4wODc2IDYuNTE5NDVDNjAuNjU4MyA3LjA3Njk4IDYxLjEwNzUgNy43NDY1MiA2MS40MDcgOC40ODYwMUM2MS43MTUyIDkuMjUwMjYgNjEuODcwNiAxMC4wNjc2IDYxLjg2NDMgMTAuODkxNkM2MS44OTUgMTIuMDg4NyA2MS42MDY5IDEzLjI3MjUgNjEuMDI5NyAxNC4zMjE2QzYwLjQwMjEgMTUuMzQ2MSA1OS40NDEzIDE2LjEyMzYgNTguMzA4NSAxNi41MjM3VjE2LjU4NzhDNTguODYzNSAxNi43MjY4IDU5LjM3OTYgMTYuOTkwMyA1OS44MTc3IDE3LjM1ODRDNjAuMjE2NSAxNy43MDI3IDYwLjU0NzYgMTguMTE4NCA2MC43OTQxIDE4LjU4NEM2MS4wNTEzIDE5LjA3NDEgNjEuMjM2OSAxOS41OTg2IDYxLjM0NTIgMjAuMTQxM0M2MS40NTYxIDIwLjcwMjQgNjEuNTMyNSAyMS4yNjk4IDYxLjU3MzkgMjEuODQwM0M2MS41OTQ1IDIyLjE5NyA2MS42MTUxIDIyLjYxNzggNjEuNjM1NyAyMy4xMDAzQzYxLjY1NjIgMjMuNTgyOCA2MS42OTUxIDI0LjA3NDQgNjEuNzQ3NyAyNC41Nzc1QzYxLjc5NTEgMjUuMDYwMiA2MS44Nzg0IDI1LjUzODYgNjEuOTk2OSAyNi4wMDg5QzYyLjA5NzEgMjYuNDE5NSA2Mi4yNzQgMjYuODA3NSA2Mi41MTgzIDI3LjE1MjNINTcuNTgzNkM1Ny4yOTAzIDI2LjMzMjEgNTcuMTIwOCAyNS40NzI4IDU3LjA4MDYgMjQuNjAyNkM1Ny4wMTgxIDIzLjYxNjMgNTYuOTI0MyAyMi42NzI3IDU2Ljc5OTMgMjEuNzcxN0M1Ni43MjM4IDIwLjgyNTMgNTYuMzQ5IDE5LjkyNzUgNTUuNzI5MSAxOS4yMDgzQzU0Ljk4IDE4LjU5MzUgNTQuMDE4NSAxOC4yOTkzIDUzLjA1MzcgMTguMzg5N0g0OC4xMTQ0VjI3LjE2ODNINDMuMTc1MlY0LjY5NDY3SDU1LjI4NzhaTTUzLjUyNyAxNC44NjM2QzU0LjQ0IDE0LjkzMjggNTUuMzQ2NSAxNC42NjQzIDU2LjA3NDQgMTQuMTA5QzU2LjM4MzQgMTMuNzg0MiA1Ni42MTkzIDEzLjM5NjkgNTYuNzY2IDEyLjk3MzNDNTYuOTEyNyAxMi41NDk2IDU2Ljk2NyAxMi4wOTk0IDU2LjkyNTEgMTEuNjUzMUM1Ni45NjQ1IDExLjIxOSA1Ni45MDg4IDEwLjc4MTYgNTYuNzYxOSAxMC4zNzEzQzU2LjYxNSA5Ljk2MDk0IDU2LjM4MDQgOS41ODc1OCA1Ni4wNzQ0IDkuMjc3MkM1NS4zNDE4IDguNzMyNTIgNTQuNDM3NCA4LjQ3MDI4IDUzLjUyNyA4LjUzODZINDguMTE0NFYxNC44NjM2SDUzLjUyN1oiIGZpbGw9IiMwMDZBQzYiLz4KPHBhdGggZD0iTTc2LjUzNzkgNC42OTQ1OEw4NC45MzY5IDI3LjE1OTFINzkuODA1Nkw3OC4xMDY2IDIyLjE1NThINjkuNzA5OEw2Ny45NDkxIDI3LjE1OTFINjIuOTc3OEw3MS40NzI5IDQuNjk0NThINzYuNTM3OVpNNzYuODMyOSAxOC40NzQyTDczLjk5MDUgMTAuMjMwN0g3My45MjY1TDcwLjk5OTUgMTguNDc0Mkg3Ni44MzI5WiIgZmlsbD0iIzAwNkFDNiIvPgo8cGF0aCBkPSJNOTAuOTQxOSA0LjY5NDU4VjE0LjAwNkw5OS43MjA2IDQuNjk0NThIMTA1Ljg4OEw5Ny4xMDkyIDEzLjU2N0wxMDYuNzM2IDI3LjE1NjhIMTAwLjUzOUw5My43NzUyIDE3LjA1ODdMOTAuOTQxOSAxOS45MjE3VjI3LjE1NjhIODYuMDAyN1Y0LjY5NDU4SDkwLjk0MTlaIiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik0xMTguMTc0IDkuOTI4ODVDMTE4LjIwMyAxMC45OTk2IDExNy45MTIgMTIuMDU0NiAxMTcuMzM4IDEyLjk1ODlDMTE2Ljc2NCAxMy44NjMyIDExNS45MzMgMTQuNTc1NSAxMTQuOTUyIDE1LjAwNDhDMTEzLjk3MSAxNS40MzQgMTEyLjg4MyAxNS41NjA2IDExMS44MyAxNS4zNjg0QzExMC43NzYgMTUuMTc2MSAxMDkuODA0IDE0LjY3MzcgMTA5LjAzNyAxMy45MjU1QzEwOC4yNzEgMTMuMTc3MyAxMDcuNzQ1IDEyLjIxNzQgMTA3LjUyNyAxMS4xNjg3QzEwNy4zMSAxMC4xMTk5IDEwNy40MSA5LjAzMDA2IDEwNy44MTUgOC4wMzg2NEMxMDguMjIxIDcuMDQ3MjIgMTA4LjkxMyA2LjE5OTM2IDEwOS44MDMgNS42MDM2MkMxMTAuNjkzIDUuMDA3ODggMTExLjc0MSA0LjY5MTM3IDExMi44MTIgNC42OTQ2MUMxMTMuNTA5IDQuNjgwOTYgMTE0LjIwMiA0LjgwNjA4IDExNC44NSA1LjA2MjdDMTE1LjQ5OSA1LjMxOTMyIDExNi4wOSA1LjcwMjMgMTE2LjU4OSA2LjE4OTM4QzExNy4wODggNi42NzY0NSAxMTcuNDg1IDcuMjU3ODkgMTE3Ljc1NyA3Ljg5OTg3QzExOC4wMjkgOC41NDE4NSAxMTguMTcxIDkuMjMxNTYgMTE4LjE3NCA5LjkyODg1Wk0xMDguNzU4IDkuOTI4ODVDMTA4Ljc0MSAxMC40NzQ2IDEwOC44MzQgMTEuMDE4MSAxMDkuMDMyIDExLjUyNjlDMTA5LjIzIDEyLjAzNTYgMTA5LjUyOSAxMi40OTkyIDEwOS45MTEgMTIuODg5N0MxMTAuMjkyIDEzLjI4MDIgMTEwLjc0OSAxMy41ODk3IDExMS4yNTMgMTMuNzk5NkMxMTEuNzU3IDE0LjAwOTUgMTEyLjI5OCAxNC4xMTU1IDExMi44NDQgMTQuMTExMkMxMTMuMzgxIDE0LjEwOTEgMTEzLjkxMiAxMy45OTkxIDExNC40MDYgMTMuNzg3OEMxMTQuODk5IDEzLjU3NjQgMTE1LjM0NiAxMy4yNjggMTE1LjcxOCAxMi44ODA5QzExNi4wOSAxMi40OTM4IDExNi4zODEgMTIuMDM1OCAxMTYuNTcyIDExLjUzNDJDMTE2Ljc2NCAxMS4wMzI2IDExNi44NTMgMTAuNDk3NiAxMTYuODM0IDkuOTYwODdDMTE2Ljg1NCA5LjQxOTI3IDExNi43NjYgOC44NzkxMyAxMTYuNTczIDguMzcyNkMxMTYuMzggNy44NjYwNyAxMTYuMDg3IDcuNDAzNSAxMTUuNzEyIDcuMDEyNDJDMTE1LjMzNyA2LjYyMTM1IDExNC44ODcgNi4zMDk3NiAxMTQuMzg5IDYuMDk2MkMxMTMuODkgNS44ODI2NCAxMTMuMzU0IDUuNzcxNDggMTEyLjgxMiA1Ljc2OTMzQzExMi4yNyA1Ljc2NzE4IDExMS43MzQgNS44NzQwOSAxMTEuMjM0IDYuMDgzNjlDMTEwLjczNCA2LjI5MzMgMTEwLjI4MSA2LjYwMTMxIDEwOS45MDMgNi45ODk0QzEwOS41MjUgNy4zNzc0OSAxMDkuMjI4IDcuODM3NzIgMTA5LjAzMiA4LjM0MjcxQzEwOC44MzUgOC44NDc2OSAxMDguNzQyIDkuMzg3MTEgMTA4Ljc1OCA5LjkyODg1Wk0xMTEuOTgyIDEyLjY3MjlIMTEwLjc3VjcuNDM4NjRDMTExLjQzMyA3LjMyMjIyIDExMi4xMDYgNy4yNjkzOCAxMTIuNzggNy4yODA4NkMxMTMuNDE0IDcuMjI2OTUgMTE0LjA1IDcuMzU5NyAxMTQuNjA5IDcuNjYyNzRDMTE0Ljc3NCA3LjgwMzExIDExNC45MDYgNy45Nzg2NyAxMTQuOTk0IDguMTc2NTNDMTE1LjA4MiA4LjM3NDQgMTE1LjEyNSA4LjU4OTUyIDExNS4xMTkgOC44MDYwOUMxMTUuMDk2IDkuMDk4OTggMTE0Ljk3OCA5LjM3NjI2IDExNC43ODIgOS41OTUyNEMxMTQuNTg2IDkuODE0MjIgMTE0LjMyNCA5Ljk2Mjc3IDExNC4wMzUgMTAuMDE4VjEwLjA4MjFDMTE0LjI5NiAxMC4xODggMTE0LjUyMyAxMC4zNjMgMTE0LjY5MSAxMC41ODgzQzExNC44NTkgMTAuODEzNSAxMTQuOTYzIDExLjA4MDUgMTE0Ljk5MSAxMS4zNjAzQzExNS4wNDMgMTEuODE1MSAxMTUuMTczIDEyLjI1NzYgMTE1LjM3NSAxMi42NjgzSDExNC4wNjdDMTEzLjg2NSAxMi4yNjU2IDExMy43MjUgMTEuODM0NyAxMTMuNjUxIDExLjM5MDFDMTEzLjU1NSAxMC44MTYxIDExMy4yMzcgMTAuNTYgMTEyLjU2NSAxMC41NkgxMTEuOTkxTDExMS45ODIgMTIuNjcyOVpNMTEyLjAxNCA5LjcwMDE5SDExMi41ODhDMTEzLjI1OCA5LjcwMDE5IDExMy44MDIgOS40NzE1MiAxMTMuODAyIDguOTMxODZDMTEzLjgwMiA4LjQ1NjIyIDExMy40NSA4LjEzMzggMTEyLjY4NCA4LjEzMzhDMTEyLjQ1OSA4LjEyOTU2IDExMi4yMzQgOC4xNTE4MiAxMTIuMDE0IDguMjAwMTFWOS43MDAxOVoiIGZpbGw9IiMwMDZBQzYiLz4KPHBhdGggZD0iTTE4LjY5MzcgOS40ODc2QzE5Ljc2NzEgOS40NTUxOCAyMC44MzYxIDkuNjM3ODkgMjEuODM3OSAxMC4wMjVMMjEuODY1MyAxMC4wNDFIMjEuODkwNUMyMS45MTc5IDEwLjA1NDcgMjIuNTc2NSAxMC4zNjExIDIyLjQ0ODQgMTEuNjY2OEMyMi40Mzk0IDExLjkwNTEgMjIuMzgyOCAxMi4xMzkxIDIyLjI4MiAxMi4zNTUxQzIyLjE4MTEgMTIuNTcxMSAyMi4wMzggMTIuNzY0OCAyMS44NjExIDEyLjkyNDZDMjEuNjg0MiAxMy4wODQ0IDIxLjQ3NzEgMTMuMjA3MiAyMS4yNTIgMTMuMjg1OEMyMS4wMjY5IDEzLjM2NDMgMjAuNzg4NCAxMy4zOTcgMjAuNTUwNSAxMy4zODE4SDIwLjQwNjRDMTguMTg4MyAxMy40MzIxIDE2LjcwNDIgMTMuNDYxOSAxNi4yMjQgMTMuNDYxOUMxNS44MjE2IDEzLjQ2MTkgMTUuMjQ3NiAxMy40ODQ3IDE0Ljc1NiAxMy41MTIyQzE0Ljc0MjMgMTIuODI2MiAxNC43MTQ4IDExLjU5MTQgMTQuNjk2NSAxMS4xNDc3QzE0LjY4NTEgMTAuNzk3OSAxNC42MjQzIDEwLjQ1MTUgMTQuNTE1OSAxMC4xMTg3QzE1LjcxMzggOS43OTc5NyAxNi45Mzg0IDkuNTg2NzMgMTguMTc0NiA5LjQ4NzZDMTguMzUyOSA5LjQ3ODQ1IDE4LjUyOSA5LjQ3Mzg4IDE4LjcwMjggOS40NzM4OCIgZmlsbD0iIzAwNkFDNiIvPgo8cGF0aCBkPSJNMTkuMzcyOSA0Ljk5MTk0QzE5LjYyOSA0Ljk5MTk0IDE5Ljg1NzcgNC45OTE5NCAyMC4wNTg5IDUuMDA3OTVDMjAuMjYwMiA1LjAyMzk2IDIwLjM5NTEgNS4wMjE2NyAyMC41MzkxIDUuMDIxNjdDMjEuMjA0NiA1LjAyMTY3IDIyLjA1MDYgNS4xMjkxNCAyMi4zMjA1IDUuNjQxMzZDMjIuNTg5NiA2LjExNTk4IDIyLjY2NzMgNi42NzU0NyAyMi41Mzc3IDcuMjA1NDZDMjIuNDcwNSA3LjU3ODk1IDIyLjI5NTYgNy45MjQ2OCAyMi4wMzQ2IDguMjAwMThDMjEuOTIzMyA4LjMxNzg0IDIxLjgwNDEgOC40Mjc4NiAyMS42Nzc5IDguNTI5NDZDMjAuNzI5MyA4LjI3MTY1IDE5Ljc1IDguMTQzOTUgMTguNzY2OSA4LjE0OTg3QzE4LjQ4MTEgOC4xNDk4NyAxOC4xOTUzIDguMTQ5ODcgMTcuOTE2MyA4LjE3OTU5QzE2LjUxNjYgOC4yOTgxNiAxNS4xMzI3IDguNTYwMjIgMTMuNzg2NSA4Ljk2MTY0QzEzLjQ2NDEgOC42OTc4NCAxMy4xMDEyIDguNDg3ODEgMTIuNzExOCA4LjMzOTY2QzEyLjUzNjUgOC4yNjgzNSAxMi4zNTYxIDguMjEwMjUgMTIuMTcyMSA4LjE2NTg3QzEzLjIyNTMgNy4wOTAxNSAxNC40ODIzIDYuMjM1MDUgMTUuODY5NyA1LjY1MDUxQzE2Ljk4ODMgNS4yMjU1MSAxOC4xNzQxIDUuMDA0NzggMTkuMzcwNiA0Ljk5ODgiIGZpbGw9IiMwMDZBQzYiLz4KPHBhdGggZD0iTTE4LjYxODQgMEMxOC43NzYyIDAgMTguOTM0IDAgMTkuMDkxOCAwLjAxMTQzMzVDMjEuODEyOSAwLjE0NjM0OCAyMi4xODExIDAuNTE2NzkzIDIyLjIwNCAxLjkyMzExQzIyLjE2OTUgMi4yNjc4NyAyMi4wNjE0IDIuNjAxMjIgMjEuODg3IDIuOTAwNjNDMjEuNzEyNyAzLjIwMDA1IDIxLjQ3NjEgMy40NTg1NiAyMS4xOTMyIDMuNjU4NzFDMjAuOTE2NiAzLjYzMzU2IDIwLjM0MDMgMy41ODU1NCAxOS42NDI5IDMuNTg1NTRDMTguNTYwNCAzLjU2Mjg1IDE3LjQ4MDkgMy43MDU1MSAxNi40NDE1IDQuMDA4NTdDMTQuNzg4NyA0LjUxNjI2IDEzLjI2NDcgNS4zNzQxOSAxMS45NzMzIDYuNTIzOTRDMTEuMjUzIDcuMTc3OTMgMTAuNTQxOCA3Ljk1NTQxIDEwLjI3MiA4LjI1NDk3QzkuOTY3MTMgOC4zNjY4NSA5LjY4NTY4IDguNTM0MzMgOS40NDE5MiA4Ljc0ODg5QzkuMzYxOTQgOC44MjEyNiA5LjI4NTYzIDguODk3NTggOS4yMTMyNSA4Ljk3NzU2QzguOTQxODUgOC43MDM1IDguNjI3NDggOC40NzU2NCA4LjI4MjU3IDguMzAyOTlDNy44OTkxNSA4LjE0Mjk2IDcuNDkwMzMgOC4wNTIzNyA3LjA3NTIgOC4wMzU0NEM3Ljg2ODQxIDYuMTI5NDQgOS4wODE1MyA0LjQyNzAyIDEwLjYyNDEgMy4wNTUwMkMxMi44NzM1IDEuMTczMzggMTUuNjg3NSAwLjA5ODAwODMgMTguNjE4NCAwVjBaIiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik0yMS44MzM0IDE0LjUxODNDMjIuMTU2IDE1LjcxNTkgMjIuMzY4IDE2Ljk0MDYgMjIuNDY2OCAxOC4xNzdDMjIuNTYyOSAxOS40MjEgMjIuMzg3MyAyMC42NzEgMjEuOTUyMyAyMS44NDAzTDIxLjkzNCAyMS44N1YyMS44OTUyQzIxLjkyMjUgMjEuOTE4MSAyMS42Njg3IDIyLjQ2OTEgMjAuNjQ0MyAyMi40NjkxQzIwLjUzMjcgMjIuNDY5NiAyMC40MjEzIDIyLjQ2MzUgMjAuMzEwNCAyMi40NTA5QzIwLjA3MjMgMjIuNDQxNiAxOS44Mzg0IDIyLjM4NDggMTkuNjIyNSAyMi4yODM4QzE5LjQwNjcgMjIuMTgyOCAxOS4yMTMyIDIyLjAzOTcgMTkuMDUzNCAyMS44NjI5QzE4Ljg5MzYgMjEuNjg2MSAxOC43NzA4IDIxLjQ3OTEgMTguNjkyMSAyMS4yNTQxQzE4LjYxMzUgMjEuMDI5MiAxOC41ODA2IDIwLjc5MDggMTguNTk1NCAyMC41NTI5VjIwLjA5NTZDMTguNTcyNSAxOS4wNDE0IDE4LjUyNDUgMTYuODQzOSAxOC41MjQ1IDE2LjIyNjVDMTguNTI0NSAxNS44MjYzIDE4LjQ5OTQgMTUuMjUyMyAxOC40NzE5IDE0Ljc1ODRDMTkuOTc0MyAxNC43MjY0IDIwLjU4MDMgMTQuNzA4MSAyMC44MDg5IDE0LjY5OUMyMS4xNTggMTQuNjg3MyAyMS41MDM2IDE0LjYyNjUgMjEuODM1NyAxNC41MTgzIiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik0yMy44MDIzIDEyLjE3NjhDMjQuODc1NyAxMy4yMzEgMjUuNzMwNSAxNC40ODY4IDI2LjMxNzcgMTUuODcyMUMyNi44MjMyIDE3LjIwOTQgMjcuMDM5MSAxOC42Mzg4IDI2Ljk1MTEgMjAuMDY1OVYyMC4xNTVDMjYuOTUxMSAyMC4yOTY4IDI2Ljk1MTEgMjAuNDI0OSAyNi45NTExIDIwLjU0MzhDMjYuOTUxMSAyMS4yMDY5IDI2Ljg0MzYgMjIuMDU1MyAyNi4zMzE0IDIyLjMyNTFDMjYuMDEzNiAyMi41MDE5IDI1LjY1NjggMjIuNTk3IDI1LjI5MzIgMjIuNjAxOEMyNS4xMTcxIDIyLjU5OTggMjQuOTQxNiAyMi41Nzk5IDI0Ljc2OTYgMjIuNTQyM0MyNC4zOTQ1IDIyLjQ3NDMgMjQuMDQ3NCAyMi4yOTg3IDIzLjc3MDMgMjIuMDM3QzIzLjY1MzEgMjEuOTI2NyAyMy41NDM4IDIxLjgwODIgMjMuNDQzMyAyMS42ODI1QzIzLjc2NTcgMjAuNDU2NCAyMy44ODAxIDE5LjE4NDkgMjMuNzgxNyAxNy45MjA5QzIzLjY2MjkgMTYuNTI1OSAyMy40MDE2IDE1LjE0NjcgMjMuMDAyIDEzLjgwNDlDMjMuMjY1NyAxMy40ODE2IDIzLjQ3NTggMTMuMTE3OSAyMy42MjM5IDEyLjcyNzlDMjMuNjk1NiAxMi41NTI3IDIzLjc1MzcgMTIuMzcyMyAyMy43OTc3IDEyLjE4ODIiIGZpbGw9IiMwMDZBQzYiLz4KPHBhdGggZD0iTTIzLjkyOCA3LjA3NDkxQzI1LjgzNTkgNy44NjcwNCAyNy41NDAxIDkuMDgwMjcgMjguOTEzIDEwLjYyMzlDMzAuOTEwMiAxMi45ODc0IDMxLjk5MDUgMTUuOTkwNSAzMS45NTY2IDE5LjA4NDZDMzEuODIxNyAyMS44MDgxIDMxLjQ0NDQgMjIuMTc2MiAzMC4wMjIxIDIyLjE5NjhDMjkuNjgwOCAyMi4xNjE5IDI5LjM1MTEgMjIuMDUzOCAyOS4wNTU1IDIxLjg3OTdDMjguNzU5OSAyMS43MDU3IDI4LjUwNTQgMjEuNDY5OSAyOC4zMDkzIDIxLjE4ODRDMjguNDc5NyAxOS41OTMzIDI4LjM2MTIgMTcuOTgwNSAyNy45NTk1IDE2LjQyNzVDMjcuNDUyMyAxNC43NzQ0IDI2LjU5NDMgMTMuMjUwMyAyNS40NDQxIDExLjk1OTNDMjQuNzU4MSAxMS4yMTYxIDIzLjk3MzggMTAuNDkxMiAyMy43MTMxIDEwLjI1OEMyMy42MDA2IDkuOTUzNDIgMjMuNDMzMiA5LjY3MjA4IDIzLjIxOTEgOS40Mjc5MkMyMy4xNDY5IDkuMzQ3NzggMjMuMDcwNiA5LjI3MTQ1IDIyLjk5MDUgOS4xOTkyNUMyMy4yNjQ1IDguOTI3ODQgMjMuNDkyNCA4LjYxMzQ3IDIzLjY2NTEgOC4yNjg1NkMyMy44MjU3IDcuODg2MDMgMjMuOTE3MSA3LjQ3Nzk5IDIzLjkzNDkgNy4wNjM0OCIgZmlsbD0iIzAwNkFDNiIvPgo8cGF0aCBkPSJNMTcuMjMyNSAxOC40NzY1QzE3LjI0ODYgMTkuMTk5MSAxNy4yNzYgMjAuNDA0MiAxNy4yOTQzIDIwLjgzODdDMTcuMzA1NyAyMS4xODg1IDE3LjM2NjUgMjEuNTM0OSAxNy40NzQ5IDIxLjg2NzdDMTYuMjc3MyAyMi4xODk4IDE1LjA1MjYgMjIuNDAxMSAxMy44MTYyIDIyLjQ5ODhDMTMuNjQ1NSAyMi41MDc5IDEzLjQ3NjMgMjIuNTEyNSAxMy4zMDg2IDIyLjUxMjVDMTIuMjMxNCAyMi41NDUgMTEuMTU4NiAyMi4zNjIzIDEwLjE1MjkgMjEuOTc1MUwxMC4xMjU1IDIxLjk1MjNIMTAuMTAyNkMxMC4wNzI5IDIxLjk0MDggOS40MTY2MyAyMS42MTg0IDkuNTQwMTEgMjAuMzI4N0M5LjU0ODgzIDIwLjA5MDYgOS42MDUwNSAxOS44NTY2IDkuNzA1NDcgMTkuNjQwNUM5LjgwNTg5IDE5LjQyNDUgOS45NDg0OCAxOS4yMzA2IDEwLjEyNDkgMTkuMDcwNEMxMC4zMDEzIDE4LjkxMDIgMTAuNTA3OSAxOC43ODY5IDEwLjczMjYgMTguNzA3N0MxMC45NTczIDE4LjYyODUgMTEuMTk1NiAxOC41OTQ5IDExLjQzMzUgMTguNjA5MUgxMS42NjIyQzEyLjUwNiAxOC41ODQgMTUuMDcxNiAxOC41MjIyIDE1Ljc3ODIgMTguNTIyMkMxNi4xOTQ0IDE4LjUyMjIgMTYuNzkzNSAxOC40OTQ4IDE3LjI0NCAxOC40NzE5IiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik0xOC4xOTk5IDIzLjAzODRDMTguNTIzMiAyMy4zMDI3IDE4Ljg4NjggMjMuNTEzNSAxOS4yNzY5IDIzLjY2MjdDMTkuNDUxOCAyMy43MzQ3IDE5LjYzMjMgMjMuNzkyIDE5LjgxNjYgMjMuODM0MkMxOC43NjMgMjQuOTA4NSAxNy41MDcxIDI1Ljc2MzQgMTYuMTIxMyAyNi4zNDk2QzE1LjAwMSAyNi43NzQ0IDEzLjgxMzggMjYuOTk1MSAxMi42MTU4IDI3LjAwMTNDMTIuMzY0MiAyNy4wMDEzIDEyLjEzNzggMjcuMDAxMyAxMS45Mjk4IDI2Ljk4M0MxMS43NTYgMjYuOTgzIDExLjYwMDUgMjYuOTcxNiAxMS40NTY0IDI2Ljk3MTZDMTAuNzkzMyAyNi45NzE2IDkuOTQ3MTkgMjYuODY0MSA5LjY3NzM2IDI2LjM1MTlDOS40MDg2OCAyNS44NzcxIDkuMzMxIDI1LjMxNzggOS40NjAxMyAyNC43ODc4QzkuNTI4MzMgMjQuNDEzOSA5LjcwMzAxIDI0LjA2NzcgOS45NjMyIDIzLjc5MDhDMTAuMDc0OCAyMy42NzM0IDEwLjE5NCAyMy41NjM0IDEwLjMxOTkgMjMuNDYxNUMxMS4yNjg3IDIzLjcxODkgMTIuMjQ3OCAyMy44NDczIDEzLjIzMDkgMjMuODQzNEMxMy41MTIxIDIzLjg0MzQgMTMuODAwMyAyMy44NDM0IDE0LjA4MTUgMjMuODExM0MxNS40NzY2IDIzLjY5MTQgMTYuODU1NyAyMy40MjkzIDE4LjE5NzYgMjMuMDI5MyIgZmlsbD0iIzAwNkFDNiIvPgo8cGF0aCBkPSJNMjIuNzgyNCAyMy4wMTU2QzIzLjA1NDkgMjMuMzEwNyAyMy4zODUxIDIzLjU0NjcgMjMuNzUyNCAyMy43MDkxQzI0LjExOTggMjMuODcxNSAyNC41MTY1IDIzLjk1NjkgMjQuOTE4MSAyMy45NkMyNC4xMjYxIDI1Ljg2OTIgMjIuOTEyIDI3LjU3NDMgMjEuMzY2OSAyOC45NDczQzE5LjExNDEgMzAuODI4OCAxNi4yOTcgMzEuOTAzMyAxMy4zNjM1IDMyQzEzLjIxMDMgMzIgMTMuMDU3MSAzMiAxMi45MDYxIDMyQzEwLjE4NSAzMS44NjUxIDkuODE2ODEgMzEuNDkyNCA5Ljc5Mzk1IDMwLjA4NjFDOS44MjgzIDI5Ljc0MTMgOS45MzYzMiAyOS40MDc5IDEwLjExMDcgMjkuMTA4NEMxMC4yODUxIDI4LjgwOSAxMC41MjE3IDI4LjU1MDUgMTAuODA0NyAyOC4zNTA1QzExLjA3OTEgMjguMzc3OSAxMS42NTc2IDI4LjQyNTkgMTIuMzU1IDI4LjQyNTlDMTMuNDM3NCAyOC40NDc2IDE0LjUxNjggMjguMzA1IDE1LjU1NjQgMjguMDAyOUMxNy4yMDk0IDI3LjQ5NTUgMTguNzMzNCAyNi42Mzc1IDIwLjAyNDYgMjUuNDg3NUMyMC43NDQ5IDI0LjgzMzUgMjEuNDU4NCAyNC4wNTM4IDIxLjcyODIgMjMuNzU0MkMyMi4wMzIzIDIzLjY0MzMgMjIuMzEzMSAyMy40NzY2IDIyLjU1NiAyMy4yNjI2QzIyLjYzNzQgMjMuMTg3NiAyMi43MTM3IDIzLjEwNzQgMjIuNzg0NyAyMy4wMjI1IiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik0xMS4zNDQzIDkuNTU2MDJDMTEuNDUxOCA5LjU1NjAyIDExLjU3MyA5LjU1NjAyIDExLjY3ODEgOS41NzQzMUMxMS45MTYzIDkuNTgzMzIgMTIuMTUwMiA5LjYzOTgzIDEyLjM2NjIgOS43NDA1MkMxMi41ODIyIDkuODQxMjIgMTIuNzc1OCA5Ljk4NDA3IDEyLjkzNTggMTAuMTYwN0MxMy4wOTU4IDEwLjMzNzMgMTMuMjE4OSAxMC41NDQxIDEzLjI5NzggMTAuNzY4OUMxMy4zNzY4IDEwLjk5MzggMTMuNDA5OSAxMS4yMzIxIDEzLjM5NTUgMTEuNDdWMTEuNjE2M0MxMy40NDU4IDEzLjkwMyAxMy40NzMyIDE1LjMzOTEgMTMuNDczMiAxNS43OTg3QzEzLjQ3MzIgMTYuMjU4MyAxMy41MDI5IDE2Ljg1NTEgMTMuNTIzNSAxNy4yNjY4QzExLjk5MzcgMTcuMjk4OCAxMS4zOTIzIDE3LjMxNzEgMTEuMTU5MSAxNy4zMjg1QzEwLjgxIDE3LjMzODQgMTAuNDY0MyAxNy4zOTg0IDEwLjEzMjMgMTcuNTA2OUM5LjgxMTE5IDE2LjMwOSA5LjU5OTk0IDE1LjA4NDQgOS41MDEyMiAxMy44NDgxQzkuNDA1MTMgMTIuNjAwNCA5LjU4Mzg4IDExLjM0NjggMTAuMDI0OSAxMC4xNzU3TDEwLjA0MDkgMTAuMTUwNlYxMC4xMjU0QzEwLjA0MDkgMTAuMTAyNSAxMC4zMDYxIDkuNTQ2ODggMTEuMzMwNiA5LjU0Njg4IiBmaWxsPSIjMDA2QUM2Ii8+CjxwYXRoIGQ9Ik02LjY3OTUyIDkuNDIzNThDNi44NTY1NCA5LjQyNTIyIDcuMDMyODcgOS40NDU5MiA3LjIwNTQ2IDkuNDg1MzJDNy41Nzk4IDkuNTUyMDEgNy45MjY0MSA5LjcyNjkgOC4yMDI0NiA5Ljk4ODRDOC4zMTk4NyAxMC4xIDguNDI5ODcgMTAuMjE5MiA4LjUzMTc0IDEwLjM0NTFDOC4yMDQ4MyAxMS41NzA1IDguMDg2NTYgMTIuODQyMSA4LjE4MTg4IDE0LjEwNjdDOC4yOTk4OSAxNS41MDU4IDguNTYxOTYgMTYuODg5IDguOTYzOTIgMTguMjM0MkM4LjY5OTgzIDE4LjU1NjkgOC40ODkwOCAxOC45MTk3IDguMzM5NjYgMTkuMzA5QzguMjY4MDQgMTkuNDgzOSA4LjIxMDY5IDE5LjY2NDQgOC4xNjgxNiAxOS44NDg2QzcuMDkzODUgMTguNzk1MSA2LjIzODkzIDE3LjUzOTEgNS42NTI3OSAxNi4xNTMzQzUuMTQ2NyAxNC44MTc3IDQuOTMwNzggMTMuMzg5NiA1LjAxOTM4IDExLjk2NDFDNS4wMTkzOCAxMS43ODU3IDUuMDMwODEgMTEuNjI1NyA1LjAzMDgxIDExLjQ4MTZDNS4wMzA4MSAxMC44MTg1IDUuMTQwNTcgOS45NzIzOSA1LjY1Mjc5IDkuNzAwMjdDNS45Njk4NyA5LjUyMzc1IDYuMzI1OCA5LjQyODY4IDYuNjg4NjYgOS40MjM1OCIgZmlsbD0iIzAwNkFDNiIvPgo8cGF0aCBkPSJNMS45NDgzMSA5LjgzMjc2QzIuMjg5MzEgOS44Njk1NCAyLjYxODUyIDkuOTc4NzMgMi45MTM5IDEwLjE1M0MzLjIwOTI4IDEwLjMyNzQgMy40NjQwMSAxMC41NjI4IDMuNjYxMDQgMTAuODQzNUMzLjQ4ODI5IDEyLjQzNzcgMy42MDYwNSAxNC4wNDk5IDQuMDA4NjIgMTUuNjAyMUM0LjUxNjcgMTcuMjU0NyA1LjM3NDU5IDE4Ljc3ODcgNi41MjM5OCAyMC4wNzAzQzcuMTY0MjYgMjAuNzc0NiA3LjkxMjAxIDIxLjQ2MjkgOC4yNTczIDIxLjc3MTZDOC4zNjkyIDIyLjA3NTkgOC41MzU4MiAyMi4zNTczIDguNzQ4OTQgMjIuNjAxN0M4LjgyMDIzIDIyLjY4MjcgOC44OTY2MSAyMi43NTkgOC45Nzc2MSAyMi44MzAzQzguNjk5NDggMjMuMTAwOSA4LjQ2NzcyIDIzLjQxNTMgOC4yOTE2IDIzLjc2MUM4LjEzMDQ5IDI0LjE0MzQgOC4wMzkxMSAyNC41NTE1IDguMDIxNzcgMjQuOTY2MUM2LjExODY1IDI0LjE2NzQgNC40MjA3NSAyMi45NDg3IDMuMDU1MDcgMjEuNDAxMUMxLjA1ODYyIDE5LjAzNzIgLTAuMDIxNTg1NiAxNi4wMzQ0IDAuMDExNDc5NCAxMi45NDA0QzAuMTQ2Mzk0IDEwLjIxMDEgMC41MTkxMjYgOS44MzI3NiAxLjkxODU4IDkuODMyNzZIMS45NDgzMVoiIGZpbGw9IiMwMDZBQzYiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF82NDQyXzExMDQ2Ij4KPHJlY3Qgd2lkdGg9IjExOC4xNzQiIGhlaWdodD0iMzIiIGZpbGw9IiMwMDZBQzYiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4=" style="height: 40px; vertical-align: middle; margin-right: 10px;" />
                </div>`


    for(const url of options.urls) {
        console.log(url)
        const page = await browser.newPage();

        page.setDefaultNavigationTimeout(180000)
        await page.setViewport({ width: 1920, height: 1080}); 
        await page.goto(url, {waitUntil: 'networkidle2',timeout: 120000 });
        await page.addStyleTag({ content: options.excludedSections? options.excludedSections : excludedSections })
        let title = await page.title()
        let pdf = await page.pdf({
            printBackground: true,
            format: 'A4',
            displayHeaderFooter: true,
            printBackground: true,
            headerTemplate,
            margin: {
                top: '80px',
                bottom: '20px',
                left: '20px',
                right: '20px'
            },
            scale: 1,
            title
        });

        // return pdf
        // archive.append(pdf, { name: title });
        pdfBlobArr.push({
            title,
            file: pdf
        })
    }

    // await new Promise(resolve => setTimeout(resolve, 10000)); 
    // await archive.finalize();
    await browser.close();

    return {
        // title,
        pdf: pdfBlobArr
    };
}

module.exports = printPdf